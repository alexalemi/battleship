To get python3 compatibility,
I had to create separate read and write socket file handlers
